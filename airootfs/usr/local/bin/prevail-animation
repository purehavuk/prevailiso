#!/bin/bash

# PREVAIL TERMINAL ANIMATION AND INFORMATION

clear
tput civis
echo -e '\e[1;38;5;93m'"
            ▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔
"
sleep 1

frames=(
"
              ████████████████████████████████████████████████████
"        
                                                                               
"
                ████████████         █████████  ███████████████                
           █████ █████    █ ███ █  ███  █  ██ █  █████ ███ ███                 
             ████  ████  ████  ████   ████  ███         █████     ███          
"                                                                               

"
                   ███████          █████  ████████      █████                 
            ████    ███          ██       █████ █   ██  ██  ████               
          █████ █████     █ ███ █  ███  █  ██ ██ ███ █████ ████                
            ████  ███  ██████  ██████████   ██████████████  █████ ████         
            █████ ████    ███████      ████████            ███████████         
"

"
                    ████            ███████████████                            
             ██████     ███████████████████████  ██████████   ████             
          ████   ██████ ██ ███  ██  ████  ████ ██    ██████  ████              
         █████ ██████    █  ██  █  ███  █  ██ ██  ██ ██ ███ ████               
           ████  █████████ ██  ██      ██       ██████     ██████  ████        
           ████  ████   ████   ████   ████  ████      ███████   ██ ████        
            █████████      █████        ██████              ██████████         
"                                                                               

"
              █████████████         ██████████   █████████████████             
          █████    ███     ██████████      ████  █  ███  ███  ████             
        █████  ███████  ██ ██  ███ █████  ████ ██    ███ ███  ████             
        █████  █████     █ ███ ██  ███  █  ██ ██  ██████ ███ ████              
          ████    ████████ ██  ██  ██  ██  █     █████      ████████████       
          ████  ████  ███████  ██████████    ███████████████  ████  ████       
          ████   ████   ████  ████    ████  ████          █████     ████       
           █████████        ██           ████                 █████████        
"

"
               ██████████           ████       ██████     ████████             
           ████████  ███████████████████████████  ██████████████████           
         █████     █   ████████████████    █████     ███  ███   ████           
       █████   ██████  ██       █    ███  █████  █    ███████  ████            
      ████   ████████ ███ ██ █ ██    ███  ████  █  ██ ██  ███ █████            
      ██████ ██████     █ ███  █  ████  █  ███ ██     ███ ███ ████             
       ██████ ██  ███████ ███  █ █████ ██  ██ █   ███ ██  ██ ████████████      
        █████ ██████████  ██  ██       ██        ████        ███████  ████     
        █████  ████  ███████  ████████████   ████████████████   ████  ████     
        █████  ████    ████   ████    ████  █████         ██████   █  ████     
         ████   ████    █████████      █████████            ██████   █████     
          █████████                       ██                   █████████       
"

"
                                     █████████████                             
               ████████             █████   █████████      ███████             
           ███████████████          ███████████   ██████████████████           
         ██████       ███████████████████ ██████  ███████████    ████          
       █████    ████            ██         █████ ██   ██  ███   ████           
      ████   ███████  ███ ███  ██  █████  █████ ██    ████████  ████           
     ████   ████████ ████    ███     ███   ███  ██  ██ ██ ████ ████            
     ██████ ██████        ███  █  ████  █  ███ ██  ███ ██ ███  ████            
      ██████ ███  ███████ ██  ██ █████  █  ██ ██       ██ ███ ████████████     
       █████   █████████  ██  ██       ██         ████        ███████  ████    
       █████  ████  ████████  ███████████    ████████████████   █████  ████    
       █████  ████   ██████   ██████  ████   █████    █████████   ███  ████    
        ████   ████   █████  █████    ████  █████           █████      ████    
        █████ █████    █████████       █████████              █████████████    
         █████████                                               ████████      
"

"                                     █████████████                             
               ███████              █████████████████        █████             
            ████████████            █████        ██████ █████████████          
         ███████     ███████████████████████████  ████████████   █████         
       ██████         █████████████████    █████      ███  ███   █████         
      █████   ██████           ██         █████  ██    ███████  █████          
    █████   ████████  ██ ████ ███  █████  █████ ███    ███████  █████          
    ████   ████████  ███     ██      ███   ███  ██  ██ ██  ███ █████           
    ██████ ███████        ███ ██  ████  █  ███ ██  ███ ███ ███ █████           
     ██████ ████ ███████ ███  ██ █████  █  ██ ██        ██ ██ █████████████    
      █████   ██████████ ███  ██       ██   █     ██████      ████████ █████   
      █████  ██████████  ██   ███████████    ████████████████  ███████  ████   
       ████  █████  ███████  █████████████   ███████ ██████████  █████  ████   
       ████  █████    ████   █████    ████   ████          ██████   ██  ████   
       ████   █████   ███████████     ███████████            ██████     ████   
       ███████████      ████████       ████████                ████████████    
        █████████                                                ████████      
"

"                                     ██████████████                            
                █████               █████████████████                          
            ████████████            ████         ██████    ██████████          
         ████████  █████████████████████████████  ████████████████████         
       ███████       ████████████████████  █████  █████████████   ████         
      █████    ████       ██████████       █████ ██   ███  ████  █████         
    █████    ███████ ███       ██    ███   ████  ██    ████████  █████         
   █████   ████████  ███ ███  ███  █████   ████ ███    ███  ███  █████         
   ████   ████████  ██       ██      ███   ███  ██  ███ ██ ████ █████          
   ██████  ██████     ██ ███  ██  ████  █  ███ ██  ████ ██ ████ █████          
    ██████ ████  ███████ ███  ██ █████  █   █  █        ██ ███ ████████████    
     █████     █████████ ███  ██        █   █     ██████    █  ██████████████  
      ████  ███████████  ██   ██        █      █ ████████      ███████   ████  
      ████  █████  ████████  ████████████    ██████████████████  ██████  ████  
      ████  █████   ██████   █████████████   ██████    █████████   ████  ████  
      ████   ████    █████   █████    ████   ████           ██████       ████  
      ████   █████    ███████████      █████████              ██████    █████  
      ███████████       ███████         ███████                 ████████████   
        ████████                                                  ████████     
"

"                                    ██████████████                            
               █████                █████████████████                          
            ███████████             ████         ███████     █████████          
         ███████████████            ███████████    ███████████████████         
       ███████      █████████████████████████████  ████████████    ████        
      █████          ██████████████████     ████       ███  ███    ████        
    ██████    █████            ██          █████  █    ███  ███   ████         
   █████   ████████  ██ ████  ██  ██████   ████  ██     ███████   ████         
  █████   ████████  ███ ███ ████   █████   ████  ██  ██ ██  ███   ████         
  ████    ███████  ██         █      ███   ███  ██   ██ ██  ███  ████          
  ██████  ██████     ██  ███  █   ███   █   ██  █   ███ ██  ███  ████          
   ██████  ███   ██████  ██   █  ████   █   █  ██        ██ ██  ████████████   
    █████  █  █████████  ██   █        ██   █      █████ █   █  █████████████  
     ████  ███████████   █   ██        ██         ███████       ███████   ████ 
     ████   █████ ████████   ████████████     █████████████████  ██████   ████ 
     ████   ████   ███████   █████████████    ███████ ██████████   ████   ████ 
     ████   ████     ████    ████     ████   ████        █████████   ███  ████ 
     ████    ████    █████  █████     ████   ████            ██████       ████ 
     ████    ████     ██████████       █████████               ██████   ██████ 
      ██████████       ███████          ███████                  ████████████  
       ████████                                                    ████████    
"

"                                      ████████████                             
                                    █████████████████                          
            █████████               ████        ██████        ███████          
          █████████████             █████          █████  █████████████        
        ██████     █████████  ██████████████████    ████████████   ████        
      █████         ████████████████████   ██████  █  █████████    ████        
    █████      ███            █████         ████   █    ██   ██    ████        
   █████    ██████   █         █           █████  █     ██   ██    ████        
  ████     ███████  ██  ████  ██  ██████   ████  ██     ███████   █████        
 ████    ████████   ██  ██  ████     ███   ████  ██   █ ██   ███  ████         
 ███     ███████   █          █      ███   ███  ██   ██  █   ██   ████         
 ████     █████      ██  ██   █  ████   █   ██  ██  ███  ██  ██  ████          
  ██████  ████   ██████  ██   █  ████   █   ██  █        ██  ██  ████████████  
    ████  ██   ███████   ██   █         █   █       ████  █  ██  █████████████ 
    ████    ██████████   █   ██         █   █      ██████       ███████    ████
    ████   █████  ████   █   █████████████    ██  ████████   █   ██████    ████
    ████   ████   ████████   █████████████    ███████ ██████████   █████   ████
    ████    ████    █████    █████    ████    █████     █████████    ███   ████
    ████    ████     ████    ████     ████   ████            █████         ████
    ████    ████     █████  ████      ████   ████              █████       ████
    █████   ████      ██████████       █████████                ██████   █████
     ██████████         ████            █████                    ███████████  
       ███████                                                      ███████    ")

initial_sleep_time=0.015
final_sleep_time=0.075

num_steps="${#frames[@]}"
step_size=$(awk "BEGIN {print (${final_sleep_time}-${initial_sleep_time})/${num_steps}}")
sleep_time=$initial_sleep_time

for ((i=0; i<${#frames[@]}; i++)); do
    tput home
    echo -e '\e[1;38;5;93m'"${frames[$i]}"
    sleep $sleep_time
    sleep_time=$(awk "BEGIN {print ${sleep_time}+${step_size}}")
done

tput cnorm

# INFO BOX
kernel=$(uname -r | awk '{split($1, a, "-"); print a[1]}')
prefix='\e[1;38;5;161m\e[1;38;5;81;48;5;242m PREVAIL OS:\e[1;37;48;5;242m Linux'
suffix='\e[1;37;48;5;242m\e[38;5;235m© 2024 - T. Higgins <purehavuk> '
reset='\e[0m'
session_type="Unknown"

# Check for Wayland session
if [ "$WAYLAND_DISPLAY" ]; then
    session_type="Wayland"
elif [ "$DISPLAY" ]; then
    # Check for X session
    session_type="X11"
elif [ -n "$(tty | grep tty)" ]; then
    # Check for TTY console
    session_type="Console"
fi

visible_length() {
    echo -e "$1" | sed 's/\x1b\[[0-9;]*m//g' | wc -c
}

len_prefix_kernel=$(visible_length "${prefix} ${kernel}")
spaces=$((49 - len_prefix_kernel))
padding=$(printf '%*s' "$spaces" '')

if [[ "$session_type" == "Wayland" || "$session_type" == "X11" ]]; then
    # WINDOWS MANAGER
    echo -e '\e[1;38;5;242m'"🭈🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬭🬽"
    echo -e "${prefix} ${kernel}${padding}${suffix}${reset}"
    echo -e '\e[1;38;5;161m\e[1;38;5;81;48;5;242m SESSION TYPE:\e[1;37;48;5;242m '"$XDG_CURRENT_DESKTOP - $session_type                                                  "'\e[0m'
    echo -e '\e[1;38;5;242m'"🭧🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🬎🭜"'\e[0m'
else
    #CONSOLE INFO
    echo ''
    echo -e ''
    echo -e "${prefix} ${kernel}${padding}${suffix}${reset}"
    echo -e '\e[1;38;5;161m\e[1;38;5;81;48;5;242m SESSION TYPE:\e[1;37;48;5;242m '"$XDG_CURRENT_DESKTOP - $session_type                                                  "'\e[0m'
    echo -e ''
    echo ''
fi